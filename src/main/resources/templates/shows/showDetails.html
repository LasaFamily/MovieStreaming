<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header"></head>
<body>
<div class="ms_main_wrapper">
    <div th:replace="fragments/sideMenu :: sideMenu"></div>
    <div class="ms_content_wrapper padder_top80">
        <div th:replace="fragments/topMenu :: topMenu"></div>

        <div class="ms_blog_single_wrapper">
            <div class="row">
                <div class="col-lg-10 col-md-10">
                    <div class="ms_blog_single">
                        <div class="blog_single_img ms_blog_section blog_active marger_bottom30 ms_genres_box" id="displayImage">
                            <img th:src="${show.showBanner != null ? 'https://www.themoviedb.org/t/p/original' + show.showBanner : '/default/default.svg'}"
                                 alt="" class="img-fluid image-height-520">
                            <div class="ms_main_overlay">
                                <div class="ms_box_overlay"></div>
                                <div class="ms_play_icon">
                                    <a href="javascript:void(0)" th:attr="onclick=|newVideo(0)|"><img th:src="@{/images/svg/play.svg}" alt=""></a>
                                </div>
                            </div>
                        </div>
                        <div class="blog_single_img ms_blog_section blog_active marger_bottom30 ms_genres_box" id="displayVideo" style="display:none;">
                            <iframe src="" style="height: 520px; width: 100%"
                                    marginheight="0"
                                    align="top" scrolling="No" frameborder="0" hspace="0" vspace="0"
                                    sandboxscrolling="no" allowfullscreen="true" id="new_video" webkitallowfullscreen="true"
                                    mozallowfullscreen="true"></iframe>
                        </div>
                        <div class="row">
                            <div class="col-lg-12 col-md-12">
                                <div class="ms_banner_text" style="padding-top:0px;text-align:center;width: 100%;">
                                    <div class="ms_banner_btn">
                                        <a href="javascript:void(0);"
                                           th:attr="onclick=|newVideo('${iter.index}')|" class="ms_btn"
                                           th:each="server, iter : ${servers}" th:text="${server}" style="width: 130px;margin:15px;">Listen Now</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="blog_single_content">
                            <h3 class="ms_blog_title" th:text="${show.showName}">Dream Your Moments</h3>
                            <div class="ms_post_meta">
                                <ul>
                                    <li th:inline="text"><span class="fa fa-calendar"></span>
                                        [[${show.firstReleaseDate}]] /
                                    </li>
                                    <li th:inline="text"><span class="fa fa-star checked"></span>
                                        [[${show.showRating}]] /
                                    </li>
                                    <li th:inline="text"><span class="fa fa-users"></span> [[${show.showPopularity}]]
                                    </li>
                                </ul>
                            </div>
                            <p th:text="${show.showOverview}">movie text</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4 col-md-4">
                            <div class="footer_box footer_contacts">
                                <h1 class="footer_title">Movie Information</h1>
                                <ul class="foo_con_info">
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/phone.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Director :</span>
                                            <span th:text="${show.showDirectors}"></span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/message.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Producer :</span>
                                            <span th:text="${show.showProducers}"></span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/add.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Seasons / Episodes :</span>
                                            <span th:inline="text">[[${show.numberOfSeasons}]] / [[${show.numberOfEpisodes}]]</span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <div class="footer_box footer_contacts">
                                <h1 class="footer_title">General Information</h1>
                                <ul class="foo_con_info">
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/phone.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Status :</span>
                                            <span th:text="${show.showStatus}"></span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/message.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Duration :</span>
                                            <span th:text="${show.showDuration}"></span>
                                        </div>
                                    </li>
                                    <li>
                                        <div class="foo_con_icon">
                                            <img th:src="@{/images/svg/add.svg}" alt="">
                                        </div>
                                        <div class="foo_con_data">
                                            <span class="con-title">Language :</span>
                                            <span th:inline="text">[[${show.showOriginalLanguage}]]</span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-lg-5 col-md-5" th:if="${show.showTrailers.size() > 0 }">
                            <div class="footer_box footer_contacts">
                                <iframe width="100%" height="230px" th:src="${'https://www.youtube.com/embed/' + show.showTrailers[0].trailerKey}" title="Yuvatha Meluko" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2">
                    <!----Sidebar Start---->
                    <div class="ms_sidebar">
                        <div class="widget widget_search blog_single_img">
                            <img th:src="${show.showPoster != null ? 'https://www.themoviedb.org/t/p/original' + show.showPoster : '/default/default.svg'}"
                                 alt="" class="img-fluid image-height-520">
                        </div>
                        <!--Categories-->
                        <div class="widget widget_categories">
                            <h2 class="widget-title">Genres</h2>
                            <ul>
                                <li th:each="genre : ${show.genres}"><a th:href="${'/genre/movies/' + genre.genericId}"
                                                                         th:text="${genre.genericName}"> Artist & Band
                                    Profile</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ms_weekly_wrapper" style="margin-bottom:2px;">
            <div class="ms_weekly_inner">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ms_heading">
                            <h1>Show Seasons</h1>
                        </div>
                    </div>

                    <div class="col-lg-12 col-md-12 padding_right40">
                        <div class="drop-down">
                            <div class="wrapper">
                                <div class="ms_weekly_box">
                                    <div class="weekly_left selected-item">
                                        <div class="w_top_song">
                                            <div class="w_tp_song_img">
                                                <img th:src="${show.seasons[0].seasonPoster != null ? 'https://image.tmdb.org/t/p/w50_and_h50_face' + show.seasons[0].seasonPoster :  '/default/default.svg'}" alt="" class="img-fluid">
                                            </div>
                                            <div class="w_tp_song_name">
                                                <h3 class="max-width-236" th:text="${show.seasons[0].seasonName}">Until I Met You </h3>
                                                <p class="max-width-236" style="color:black;" th:text="${show.seasons[0].seasonReleaseDate}">Ava Cornish</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <i class="fa fa-arrow-down arrow" aria-hidden="true"></i>
                            <div class="list">
                                <div class="item" th:each="season : ${show.seasons}">
                                    <div class="ms_weekly_box showItems">
                                        <div class="weekly_left">
                                            <div class="w_top_song">
                                                <div class="w_tp_song_img">
                                                    <img th:src="${season.seasonPoster != null ? 'https://image.tmdb.org/t/p/w50_and_h50_face' + season.seasonPoster :  '/default/default.svg'}" alt="" class="img-fluid">
                                                </div>
                                                <div class="w_tp_song_name">
                                                    <h3 class="max-width-236" th:text="${season.seasonName}">Until I Met You</h3>
                                                    <p th:text="${season.seasonReleaseDate}" class="max-width-236" style="color:black;">Ava Cornish</p>
                                                    <span class="seasonNumber" th:text="${season.seasonNumber}" style="display:none;"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ms_weekly_wrapper">
            <div class="ms_weekly_inner">
                <span id="appendData"></span>
            </div>
        </div>
        <div class="ms_rcnt_slider padder_top30">
            <div class="ms_heading">
                <h1>Recommendation Shows</h1>
            </div>
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide" th:each="show : ${shows}">
                        <div class="ms_rcnt_box">
                            <div class="ms_rcnt_box_img">
                                <img th:src="${show.showPoster != null ? 'https://www.themoviedb.org/t/p/original' + show.showPoster :
                                show.showBanner != null ? 'https://www.themoviedb.org/t/p/original' + show.showBanner : '/default/default.svg'}" alt="" class="image-height-255">
                                <div class="ms_main_overlay">
                                    <div class="ms_box_overlay"></div>
                                    <div class="ms_play_icon">
                                        <a th:href="${'/show/details/' + show.showId}"><img th:src="@{/images/svg/play.svg}" alt=""></a>
                                    </div>
                                </div>
                            </div>
                            <div class="ms_rcnt_box_text">
                                <h3 class="text-ellipsis"><a th:href="${'/show/details/' + show.showId}" th:text="${show.showName}">Dream Your Moments (Duet)</a></h3>
                                <p th:text="${show.showReleaseDate}">Ava Cornish & Brian Hill</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Add Arrows -->
            <div class="swiper-button-next slider_nav_next"></div>
            <div class="swiper-button-prev slider_nav_prev"></div>
        </div>
        <div class="ms_weekly_wrapper">
            <div class="ms_weekly_inner">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ms_heading">
                            <h1>Show Cast</h1>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 padding_right40" th:each="person, iter : ${show.showCasts}">
                        <div class="ms_weekly_box">
                            <div class="weekly_left">
                                    <span class="w_top_no"
                                          th:text="${(iter.index + 1) <= 9 ? '0'+ (iter.index + 1) : iter.index + 1}">
										01
									</span>
                                <div class="w_top_song">
                                    <div class="w_tp_song_img">
                                        <img th:src="${person.personImage != null ? 'https://image.tmdb.org/t/p/w50_and_h50_face' + person.personImage :  '/default/default.svg'}"
                                             alt="" class="img-fluid">
                                        <div class="ms_song_overlay">
                                        </div>
                                        <div class="ms_play_icon">
                                            <a th:href="${'/person/shows/' + person.personId}"><img
                                                    th:src="@{/images/svg/play.svg}" alt=""></a>
                                        </div>
                                    </div>
                                    <div class="w_tp_song_name">
                                        <h3 class="max-width-236"><a th:href="${'/person/shows/' + person.personId}"
                                                                     th:text="${person.personName}">Until I Met You</a>
                                        </h3>
                                        <p th:text="${person.personJob}" class="max-width-236">Ava Cornish</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ms_divider"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ms_weekly_wrapper">
            <div class="ms_weekly_inner">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ms_heading">
                            <h1>Show Crew</h1>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-12 padding_right40" th:each="person, iter : ${show.showCrews}">
                        <div class="ms_weekly_box">
                            <div class="weekly_left">
                                    <span class="w_top_no"
                                          th:text="${(iter.index + 1) <= 9 ? '0'+ (iter.index + 1) : iter.index + 1}">
										01
									</span>
                                <div class="w_top_song">
                                    <div class="w_tp_song_img">
                                        <img th:src="${person.personImage != null ? 'https://image.tmdb.org/t/p/w50_and_h50_face' + person.personImage :  '/default/default.svg'}"
                                             alt="" class="img-fluid">
                                        <div class="ms_song_overlay">
                                        </div>
                                        <div class="ms_play_icon">
                                            <a th:href="${'/person/shows/' + person.personId}">
                                                <img th:src="@{/images/svg/play.svg}" alt="">
                                            </a>
                                        </div>
                                    </div>
                                    <div class="w_tp_song_name">
                                        <h3 class="max-width-236">
                                            <a th:href="${'/person/shows/' + person.personId}" th:text="${person.personName}">Until I Met You</a>
                                        </h3>
                                        <p th:text="${person.personJob}" class="max-width-236">Ava Cornish</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ms_divider"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:replace="fragments/scriptFile :: scriptFile"></div>
<script type="text/javascript" th:inline="javascript">
 //<![CDATA[
  var showId = [[${showId}]];
  var seasonNumber = [[${seasonNumber}]];
  var episodeNumber = [[${episodeNumber}]];
  var tmdbId = [[${tmdbId}]];
	$(function() {
	    $.get("/show/season/episodes/?showId=" + showId + "&seasonNumber=" + seasonNumber, function(response) {
            $("#appendData").html(response);
        });

		const dropdown = document.querySelector('.drop-down');
        const list = document.querySelector('.list');
        const selected = document.querySelector('.selected');
        const selectedImg = document.querySelector('.selectedImg');
        dropdown.addEventListener('click', () => {
            list.classList.toggle('show');
            dropdown.classList.toggle('active');

        });

        $('.showItems').click(function() {
            $(".selected-item").html($(this).html());
            seasonNumber = $(".selected-item .seasonNumber").text();
            episodeNumber = 1;
            $.get("/show/season/episodes/?showId=" + showId + "&seasonNumber=" + seasonNumber, function(response) {
                $("#appendData").html(response);
             });
             $.get("/show/season/episode/server?showId=" + showId + "&tmdbId=" + tmdbId + "&seasonNumber=" + seasonNumber + "&episodeNumber=" + episodeNumber + "&serverId=" + 0, function(response) {
                  console.log(response);
                  $("#displayImage").hide();
                  $("#displayVideo").show();
                  $("#new_video").attr('src', response);
                  window.scrollTo(0, 0);
             });
        })
	});

	function newVideo(serverId) {
        $.get("/show/season/episode/server?showId=" + showId + "&tmdbId=" + tmdbId + "&seasonNumber=" + seasonNumber + "&episodeNumber=" + episodeNumber + "&serverId=" + serverId, function(response) {
              console.log(response);
              $("#displayImage").hide();
              $("#displayVideo").show();
              $("#new_video").attr('src', response);
              window.scrollTo(0, 0);
         });
    }

	function streamingEpisode(episode, serverId) {
	    episodeNumber = episode;
        $.get("/show/season/episode/server?showId=" + showId + "&tmdbId=" + tmdbId + "&seasonNumber=" + seasonNumber + "&episodeNumber=" + episodeNumber + "&serverId=" + serverId, function(response) {
              $("#displayImage").hide();
              $("#displayVideo").show();
              $("#new_video").attr('src', response);
              window.scrollTo(0, 0);
         });
    }
 // ]]>
</script>
</body>
</html>